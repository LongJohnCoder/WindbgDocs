<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"><HTML DIR="LTR" xmlns:MSHelp="http://msdn.microsoft.com/MSHelp">
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<TITLE>The VSSDump Tool</TITLE>
<META NAME="ms.locale" content="en-us">
<META NAME="DESCRIPTION" CONTENT="Debugger, Debugger, Design Guide, The VSSDump Tool"><xml><MSHelp:Keyword Index="A" Term="SymChk_f6adac45-9f38-4b69-9cc7-0e2e40bc67e2.xml"/>
<META NAME="MS-HKWD" CONTENT="SrcSrv, VSSDump tool">
<META NAME="MS-HKWD" CONTENT="VSSDump tool"></xml><LINK REL="stylesheet" type="text/css" href="backsdk4.css"><SCRIPT src="langref.js"></SCRIPT><style>dd {margin-bottom:0em; margin-left:1.9em; }</style>
<style>.divclass {behavior:url(#default#savehistory);}</style>
<META NAME="save" CONTENT="history">
</HEAD>
<Body topmargin="0">
<DIV STYLE="display:none;"></DIV>
<DIV STYLE="display:none;"></DIV>
<TABLE CLASS="buttonbarshade" CELLSPACING="0" border="0"><TR><TD NOWRAP="true"> </TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING="0">
<TR ID="hdr">
<TD NOWRAP="true" CLASS="runninghead">Debugging Tools for Windows</TD>
</TR>
</TABLE>
<H1><A NAME="SymChk_f6adac45-9f38-4b69-9cc7-0e2e40bc67e2.xml"></A>The VSSDump Tool</H1>
<P>The VSSDump (<i>Vssdump.exe</i>) tool is used by the indexing script for Microsoft Visual SourceSafe.  It gathers the list of source files to be indexed.  This program is also a valuable command-line utility that you can use to examine which files may be processed by the indexing script.</P>
<P>To prepare for source indexing, edit <i>Srcsrv.ini </i>so that it contains an entry for your version control server.  This is an operation that you must do only once.  Details are listed in the sample version <i>Srcsrv.ini</i>.  You can use an environment variable or switch to the indexing script to denote the location of this file. However, it is best to put it in the same directory as the script because the contents of this file are intended to be global across all projects in your business or development system.  This file serves to uniquely identify different version control servers.  Note that you can provide a different version of this file to debuggers so that they look at a replicated copy of the version control server, which can be useful if you want to reduce traffic on the server.</P>
<P>To source-index a particular build, make certain that no source files are checked out on the build computer.  If any files are checked out and edited, those changes are not reflected in the final source indexed <i>.pdb</i> files.  Furthermore, if your build process includes a pre-compilation pass that generates source files from other files, you must check in those generated files to version control as part of the pre-compilation.</P>
<P>Upon completion of the build, set the current working directory to be the root of all source files and generated <i>.pdb</i> files.  Then run SSIndex.  You must specify what version control system you are using as a parameter.  For example:</P>
<P style="cursor:text; padding:2pt,4pt;font: 100% Courier New, Courier, mono; color: #660000;"><nobr><b>ssindex.cmd &#8211;server=</b>vss<BR></nobr></P>
<P>SSIndex<i> </i>accepts parameters that allow you to run the script from anywhere and to specify the location of the source files and <i>.pdb</i> files separately.  This is most useful if the source is kept in another location from the output <i>.pdb</i> files.  For example:</P>
<P style="cursor:text; padding:2pt,4pt;font: 100% Courier New, Courier, mono; color: #660000;"><nobr><b>ssindex.cmd &#8211;server=</b>vss<b> &#8211;source=</b><i>c:\source </i><b>&#8211;symbols=</b><i>c:\outputdir</i><BR></nobr></P>
<P>These directories can also be specified with environment variables.  Use the <nobr><b>-?</b></nobr> or <nobr><b>-??</b></nobr> command line options for more information.</P>
<P>Here is an example of the output generated by this script:</P>
<P style="cursor:text; padding:2pt,4pt;font: 100% Courier New, Courier, mono; color: #660000;"><nobr><b>C:\ &gt;ssindex.cmd -system=</b><i>vss </i><b>-?</b><BR>--------------------------------------------------------------------------------<BR>SSIndex.cmd [/option=&lt;value&gt; [...]] [ModuleOptions] [/Debug]<BR>General SrcSrv settings:<BR>     NAME              SWITCH      ENV. VAR        Default<BR>  -----------------------------------------------------------------------------<BR>  1) srcsrv.ini        Ini         SRCSRV_INI      .\srcsrv.ini<BR>  2) Source root       Source      SRCSRV_SOURCE   .<BR>  3) Symbols root      Symbols     SRCSRV_SYMBOLS  .<BR>  4) Control system    System      SRCSRV_SYSTEM   &lt;N/A&gt;<BR>  5) Save File (opt.)  Save        SRCSRV_SAVE     &lt;N/A&gt;<BR>  6) Load File (opt.)  Load        SRCSRV_LOAD     &lt;N/A&gt;<BR>Visual Source Safe specific settings:<BR>     NAME            SWITCH      ENV. VAR        Default<BR>  -----------------------------------------------------------------------------<BR>  A) VSS Server      Server      SSDIR            &lt;N/A&gt;<BR>  B) VSS Client      Client      SSROOT           &lt;Current directory&gt;<BR>  C) VSS Project     Project     SSPROJECT        &lt;N/A&gt;<BR>  D) VSS Label       Label       SSLABEL          &lt;N/A&gt;<BR>Precedence is: Default, environment, cmdline switch. (ie. env overrides default,<BR>switch overrides env).<BR>Using '/debug' will turn on verbose output.<BR>Use "SSIndex.cmd -??" for verbose help information.<BR>See SrcSrv documentation for more information.<BR>--------------------------------------------------------------------------------<BR></nobr></P>
<P>You can also use one of the provided wrapper scripts (<i>Vssindex.cmd</i>) to avoid specifying the version control system.  The script source-indexes all <i>.pdb</i> files found in the current directory and below with version control information to locate all source files found in the current directory and below.  You can specify different locations for these files by using environment variables and command-line switches.</P>
<P>Upon completion of the source indexing, you can test the output by running SrcTool<i> </i>on the <i>.pdb</i> files.  This program displays data that indicates whether or not the <i>.pdb</i> file is source indexed.  It also displays the specific information for every source file.  Lastly, it displays the number of indexed sources and the number of sources that no indexing information was found for.  It sets an %ERRORLEVEL% of -1 if the file is not source-indexed.  Otherwise, it sets %ERRORLEVEL% to the number of indexed source files.</P>
<P>VSSDump can also be used independently to diagnose issues while source-indexing.  The syntax is as follows:</P>
<P style="cursor:text; padding:2pt,4pt;font: 100% Courier New, Courier, mono; color: #660000;"><nobr><b>vssdump.exe </b><i>Options</i><BR></nobr></P>
<P></P>
<P><i>Options</i> can be any combination of the following options.</P>
<DL><DT><b>-a</b></DT>
<DD>Causes all projects to be searched, rather than restricting to the current project.  This option may not be used with the <b>&#8211;p</b> option.</DD>
<DT><b>-p </b><i>ProjectName</i></DT>
<DD>Causes <i>VSSDump</i> to restrict its search to the project specified by <i>ProjectName</i>.  If this option is not present, the current project is used.  This option may not be used with the <b>&#8211;a</b> option.</DD>
<DT><b>-d</b> <i>RootDirectory</i></DT>
<DD>Causes <i>VSSDump</i> to restrict its search to the root directory specified by <i>RootDirectory</i>.  If this option is not present, the current directory is used.</DD>
<DT><b>-l</b> <i>Label</i></DT>
<DD>Causes <i>VSSDump</i> to list only those files with a label that matches that specifed by <i>Label</i>.  </DD>
<DT><i>VSSDump</i><b>-v </b><i>SharePath</i></DT>
<DD>Specifies that the location of the Virtual SourceSafe database is in <i>SharePath</i>.  This option overrides the path specified in the SSDIR environment variable.</DD>
<DT><b>-r</b></DT>
<DD>Causes <i>VSSDump</i> to search subdirectories recursively.</DD>
<DT><b>-f</b></DT>
<DD>Causes <i>VSSDump</i> to list directories containing source files without listing the files themselves.</DD>
<DT><b>-i</b></DT>
<DD>Causes <i>VSSDump</i> to ignore the current directory and list the entire project.  This option may not be used with <b>&#8211;r</b>.  </DD>
<DT><b>-s</b></DT>
<DD>Causes <i>VSSDump</i> to format ouput for use with script files.</DD>
<DT><b>-c</b></DT>
<DD>Causes <i>VSSDump</i> to display only the Virtual SourceSafe configuration information.</DD>
</DL>
<P></P>
<P></P>
<DIV style="display:yes"></DIV>
<DIV CLASS="footer"><br><A href="dbglegal.htm">© 2009 Microsoft Corporation</A><br><A href="mailto:windbgfb@microsoft.com?subject=documentation feedback [Debugger]: The VSSDump Tool RELEASE: (December 09, 2009)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AThe WDK team uses the feedback submitted to improve the WDK documentation. We do not use your e-mail address for any other purpose. We will remove your e-mail address from our system after the issue you are reporting has been resolved. While we are working to resolve this issue, we may send you an e-mail message to request more information about your feedback. After the issues have been addressed, we may send you an e-mail message to let you know that your feedback has been addressed.%0A%0AFor more information about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx.
              ">Send feedback on this topic</A><br>Debugging Tools for Windows<br>December 09, 2009<br></DIV>
</Body>
</HTML>
